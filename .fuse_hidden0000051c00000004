/// <reference path="jquery.d.ts"/>
interface Drawable {
	context:any;
	render:() => void;
}

var DEFAULT_LENGTH:number = 5;
var DIRECTIONS:any = {
	"UP":1,
	"DOWN":2,
	"LEFT":3,
	"RIGHT":4
}
var MOVE_UNIT:number = 10;
var SNAKE_BLOCK_DIMS:number = 10;

class Snake implements Drawable {
	length:number=DEFAULT_LENGTH;
	x:number;
	y:number;
	direction:number=DIRECTIONS.RIGHT;
	constructor(public context:any, public isAI:boolean){
		if (!this.isAI) {
			this.x = 0;
			this.y = 0;
		}
	}
	render() {
		this.move();
		for (var i=0;i<=this.length;i++) {
			this.context.fillStyle = "white";
			this.context.fillRect(this.x+(i*(SNAKE_BLOCK_DIMS+2)), this.y, SNAKE_BLOCK_DIMS, SNAKE_BLOCK_DIMS);
		}
	}
	move() {
		if (this.direction == DIRECTIONS.UP) {
			this.y -= MOVE_UNIT;
		}
		else if (this.direction == DIRECTIONS.DOWN) {
			this.y += MOVE_UNIT;
		}
		else if (this.direction == DIRECTIONS.LEFT) {
			this.x -= MOVE_UNIT;
		}
		else {
			this.x += MOVE_UNIT;
		}

	}
}

class SnakeGame {
	canvas:HTMLElement;
	context:any;
	human:Snake;
	constructor() {
		this.canvas = $("canvas")[0];
		this.context = this.canvas.getContext("2d");
		this.human = new Snake(this.context, false);

		this.render();
	}
	render() {
		this.canvas.width = window.innerWidth;
		this.canvas.height = window.innerHeight;

		this.context.clearRect(0, 0, window.innerWidth, window.innerHeight);
		this.context.fillStyle = "black";
		this.context.fillRect(0, 0, window.innerWidth, window.innerHeight);

		this.human.render();
		window.setTimeout(function() {
			window.requestAnimationFrame(this.render.bind(this))

		}.bind(this), 200);
	}
}

$(document).ready(function() {
	var game = new SnakeGame();
})